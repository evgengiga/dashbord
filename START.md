# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - Dashboard Service

## –ß—Ç–æ —ç—Ç–æ?

–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–∞—à–±–æ—Ä–¥-—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π:
- ‚úÖ –õ–æ–≥–∏–Ω–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ email
- ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Planfix API
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å—ã, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å –¥–∞–Ω–Ω—ã–º–∏

## –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Backend

### 1.1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.11+

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é:
```bash
python --version
```

### 1.2. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
cd backend
python -m venv venv
```

### 1.3. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

**Windows (PowerShell):**
```bash
venv\Scripts\activate
```

**Windows (CMD):**
```bash
venv\Scripts\activate.bat
```

### 1.4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

### 1.5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ backend

```bash
python run.py
```

‚úÖ Backend –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:8000`

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:8000/api/docs - —É–≤–∏–¥–∏—Ç–µ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

## –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Frontend

–û—Ç–∫—Ä–æ–π—Ç–µ **–ù–û–í–û–ï –æ–∫–Ω–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞** (–Ω–µ –∑–∞–∫—Ä—ã–≤–∞—è backend!)

### 2.1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js 18+

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é:
```bash
node --version
npm --version
```

–ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω - —Å–∫–∞—á–∞–π—Ç–µ —Å https://nodejs.org/

### 2.2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd frontend
npm install
```

### 2.3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ frontend

```bash
npm run dev
```

‚úÖ Frontend –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:5173`

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:5173

---

## –®–∞–≥ 3: –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173
2. –í–≤–µ–¥–∏—Ç–µ email —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –µ—Å—Ç—å –≤ Planfix
3. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"
4. –í—ã —É–≤–∏–¥–∏—Ç–µ –¥–∞—à–±–æ—Ä–¥ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ —ç—Ç–æ–º—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É

---

## –®–∞–≥ 4: –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ SQL-–∑–∞–ø—Ä–æ—Å—ã

–°–µ–π—á–∞—Å –¥–∞—à–±–æ—Ä–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã.

### 4.1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª

```
backend/app/services/dashboard_service.py
```

### 4.2. –ù–∞–π–¥–∏—Ç–µ –º–µ—Ç–æ–¥—ã `_get_conversions_data` –∏ `_get_preparation_time_data`

### 4.3. –ó–∞–º–µ–Ω–∏—Ç–µ –ø—Ä–∏–º–µ—Ä–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ

–ü—Ä–∏–º–µ—Ä:

```python
def _get_conversions_data(self, user_full_name: str) -> List[Dict]:
    query = """
    SELECT 
        manager_name as "–ú–µ–Ω–µ–¥–∂–µ—Ä",
        kp_count as "–ö–æ–ª-–≤–æ –ö–ü",
        conversion_rate as "–ö–æ–Ω–≤–µ—Ä—Å–∏—è"
    FROM your_real_table_name
    WHERE "user" = :user_name
    ORDER BY kp_count DESC
    LIMIT 100
    """
    
    try:
        result = execute_query(query, {"user_name": user_full_name})
        return result
    except Exception as e:
        print(f"Error: {e}")
        return []
```

**–í–ê–ñ–ù–û:** 
- –ó–∞–º–µ–Ω–∏—Ç–µ `your_real_table_name` –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
- –í –∑–∞–ø—Ä–æ—Å–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `WHERE "user" = :user_name` - —ç—Ç–æ —Ñ–∏–ª—å—Ç—Ä –ø–æ –§–ò–û
- `:user_name` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–º–µ–Ω–∏—Ç—Å—è –Ω–∞ –§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ª–æ–≥–∏–Ω–∏–ª—Å—è

### 4.4. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –º–µ—Ç–æ–¥ `_get_conversions_data`, –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –µ–≥–æ –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π SQL-–∑–∞–ø—Ä–æ—Å.

–ó–∞—Ç–µ–º –¥–æ–±–∞–≤—å—Ç–µ –≤—ã–∑–æ–≤ –≤ –º–µ—Ç–æ–¥ `get_dashboard_data`:

```python
def get_dashboard_data(self, user_full_name: str) -> List[Dict[str, Any]]:
    dashboard_items = []
    
    # –í–∞—à –Ω–æ–≤—ã–π –¥–∞—à–±–æ—Ä–¥
    my_data = self._get_my_custom_data(user_full_name)
    if my_data:
        dashboard_items.append({
            "id": "my_custom",
            "title": "–ú–æ–π –¥–∞—à–±–æ—Ä–¥",
            "description": "–û–ø–∏—Å–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞",
            "data": my_data,
            "columns": list(my_data[0].keys()) if my_data else []
        })
    
    return dashboard_items
```

### 4.5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend

–ù–∞–∂–º–∏—Ç–µ `Ctrl+C` –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å backend –∏ —Å–Ω–æ–≤–∞:

```bash
python run.py
```

### 4.6. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–ù–∞–∂–º–∏—Ç–µ F5 - —É–≤–∏–¥–∏—Ç–µ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ!

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### ‚úÖ Backend —Ä–∞–±–æ—Ç–∞–µ—Ç?

–û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:8000/api/health

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```json
{
  "status": "healthy",
  "database": "connected",
  "service": "Dashboard Service"
}
```

### ‚úÖ Frontend —Ä–∞–±–æ—Ç–∞–µ—Ç?

–û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:5173

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞

### ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Planfix —Ä–∞–±–æ—Ç–∞–µ—Ç?

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º email —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏–∑ Planfix

### ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL —Ä–∞–±–æ—Ç–∞–µ—Ç?

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ health check (—Å–º. –≤—ã—à–µ)

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–æ–ª–±—Ü–∞ "user" –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–í –≤–∞—à–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö PostgreSQL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç–æ–ª–±–µ—Ü `user` —Å –ø–æ–ª–Ω—ã–º –§–ò–û —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:**
- "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"
- "–ü–µ—Ç—Ä–æ–≤–∞ –ú–∞—Ä–∏—è –°–µ—Ä–≥–µ–µ–≤–Ω–∞"

–§–ò–û –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ç–µ–º, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Planfix API!

---

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå "Database connection failed"

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PostgreSQL —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ `backend/.env` (host, port, user, password)
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î –¥—Ä—É–≥–∏–º –∫–ª–∏–µ–Ω—Ç–æ–º (DBeaver, pgAdmin)

### ‚ùå "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ Planfix"

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ email –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Planfix
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω Planfix API –≤ `backend/.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω –∏ –Ω–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏

### ‚ùå Frontend –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ backend

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8000
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `backend/.env`
- –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Network –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ—à–∏–±–∫–∏

### ‚ùå –¢–∞–±–ª–∏—Ü—ã –ø—É—Å—Ç—ã–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –ó–∞–º–µ–Ω–∏—Ç–µ –ø—Ä–∏–º–µ—Ä–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ (—Å–º. –®–∞–≥ 4)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ –ë–î –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ "user" –≤ –≤–∞—à–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–î–æ–±–∞–≤—å—Ç–µ –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã** (–®–∞–≥ 4)
2. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**
3. ‚úÖ **–î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –¥–∞—à–±–æ—Ä–¥–æ–≤** (–≥—Ä–∞—Ñ–∏–∫–∏, –º–µ—Ç—Ä–∏–∫–∏ –∏ —Ç.–¥.)
4. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ production –¥–µ–ø–ª–æ–π** (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã)

---

## –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

- üìñ Backend README: `backend/README.md`
- üìñ Frontend README: `frontend/README.md`
- üìñ API Docs: http://localhost:8000/api/docs (–∫–æ–≥–¥–∞ backend –∑–∞–ø—É—â–µ–Ω)

–£–¥–∞—á–∏! üöÄ


